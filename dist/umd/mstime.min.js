!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.mstime=t()}(this,function(){"use strict";var e=require("./present"),t=require("./utils"),n=t.config,r=t.plugins,i=t.format,a=require("./default-plugins/msPluginTrimMean"),s=require("./default-plugins/msPluginChartist"),l={},u={};return{config:n,plugins:r,timers:l,start:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e();(u=n()).consoleTime&&console.time(t),l[t]=l[t]||{entries:[]};var a={timestamp:+new Date,start:i};return r.data&&(a.data=r.data),l[t].entries.push(a),l[t]},end:function(t){var n=e();u.consoleTime&&console.timeEnd(t);var a=l[t];if(!a)return null;a.plugins={};var s=a.entries,o=s[s.length-1];o.diff=n-o.start,a.last=o.diff,a.sum=(a.sum||0)+o.diff,a.avg=a.sum/s.length,a.name=t,o.avg=a.avg,a.last=i(a.last),o.start=i(o.start),o.end=i(n),o.diff=i(o.diff),a.sum=i(a.sum),a.avg=i(a.avg);for(var m=r(),g=0;g<m.length;g+=1){var f=m[g].plugin;f&&f.run&&(a.plugins[f.name]=f.run(l,a))}return a},clear:function(e){delete l[e];for(var t=r(),n=0;n<t.length;n+=1){var i=t[n].plugin;i&&i.clear&&i.clear()}},msPluginUseLocalStorage:function(){var e=JSON.parse(global.localStorage.getItem("mstime.timers"));return e&&(l=e),{name:"msplugin-use-local-storage",run:function(e,t){global.localStorage.setItem("mstime.timers",JSON.stringify(l));var n=global.localStorage.getItem("mstime.timers");return{createdAt:(new Date).getTime(),totalEntries:t.entries.length,size:n.length}},clear:function(){global.localStorage.setItem("mstime.timers",JSON.stringify(l))}}},msPluginTrimMean:a,msPluginChartist:s}});
