!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.mstime=t()}(this,function(){"use strict";var e=require("./present"),t=require("./utils"),n=t.config,r=t.plugins,a=t.format,i={},s={};return{config:n,plugins:r,timers:i,start:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=e();(s=n()).consoleTime&&console.time(t),i[t]=i[t]||{entries:[]};var l={timestamp:+new Date,start:a};return r.data&&(l.data=r.data),i[t].entries.push(l),i[t]},end:function(t){var n=e();s.consoleTime&&console.timeEnd(t);var l=i[t];if(!l)return null;l.plugins={};var o=l.entries,u=o[o.length-1];u.diff=n-u.start,l.last=u.diff,l.sum=(l.sum||0)+u.diff,l.avg=l.sum/o.length,l.name=t,u.avg=l.avg,l.last=a(l.last),u.start=a(u.start),u.end=a(n),u.diff=a(u.diff),l.sum=a(l.sum),l.avg=a(l.avg);for(var m=r(),g=0;g<m.length;g+=1){var f=m[g].plugin;f&&f.run&&(l.plugins[f.name]=f.run(i,l))}return l},clear:function(e){delete i[e];for(var t=r(),n=0;n<t.length;n+=1){var a=t[n].plugin;a&&a.clear&&a.clear()}},msPluginUseLocalStorage:function(){var e=JSON.parse(global.localStorage.getItem("mstime.timers"));return e&&(i=e),{name:"msplugin-use-local-storage",run:function(e,t){global.localStorage.setItem("mstime.timers",JSON.stringify(i));var n=global.localStorage.getItem("mstime.timers");return{createdAt:(new Date).getTime(),totalEntries:t.entries.length,size:n.length}},clear:function(){global.localStorage.setItem("mstime.timers",JSON.stringify(i))}}}}});
