!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.mstime=t()}(this,function(){"use strict";var e=require("./present"),t=require("./utils"),n=t.config,i=t.plugins,r=t.format,s={},a={};return{config:n,plugins:i,timers:s,start:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=e();(a=n()).consoleTime&&console.time(t),s[t]=s[t]||{entries:[]};var u={timestamp:+new Date,start:r(o)};return i.data&&(u.data=i.data),s[t].entries.push(u),s[t]},end:function(t){var n=e();a.consoleTime&&console.timeEnd(t);var o=s[t];if(!o)return null;o.plugins={};var u=o.entries,m=u[u.length-1];m.end=r(n),m.diff=r(m.end-m.start),o.last=m.diff,o.sum=r((o.sum||0)+m.diff),o.avg=r(o.sum/u.length);for(var l=i(),f=0;f<l.length;f+=1){var c=l[f].plugin;c&&c.run&&(o.plugins[c.name]=c.run(s,o))}return o},clear:function(e){delete s[e]},mstimePluginUseLocalStorage:function(){var e=JSON.parse(global.localStorage.getItem("mstime.timers"));return e&&(s=e),{name:"mstime-plugin-use-local-storage",run:function(e){global.localStorage.setItem("mstime.timers",JSON.stringify(s));var t=global.localStorage.getItem("mstime.timers");return{createdAt:(new Date).getTime(),totalEntries:e.entries.length,size:t.length}}}},mstimePluginTrimMean:function(e){var t=e.config,n=void 0===t?{}:t;return{name:"mstime-plugin-trim-mean",run:function(e,t){var i=void 0!==n.percent?n.percent:.2,s=void 0!==n.includeItems&&n.includeItems,a=t.entries.sort(function(e,t){return e.diff-t.diff}),o=a.length,u=Math.round(o*i),m=o-u,l=a.slice(u,m),f=0;l.map(function(e){return f+=e.diff,e});var c={percent:n.percent,sum:r(f),mean:r(f/l.length)};return s&&(c.items=l),c}}}}});
