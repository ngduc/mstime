!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.mstime=t()}(this,function(){"use strict";function e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a=o({},a,e)}function t(e){if(e){s=e;for(var t=0;t<s.length;t+=1){var n=s[t];n.plugin=n.plugin({config:n.config})}}return s}function n(e){return parseFloat(e.toFixed(a.decimalDigits))}var r=global.performance||{},i=function(){if("undefined"!=typeof process&&process.hrtime)return function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6};for(var e=["now","webkitNow","msNow","mozNow","oNow"];e.length;){var t=e.shift();if(t in r)return r[t].bind(r)}var n=Date.now||function(){return(new Date).getTime()},i=(r.timing||{}).navigationStart||n();return function(){return n()-i}}();i.performanceNow=r.now,i.noConflict=function(){r.now=i.performanceNow},i.conflict=function(){r.now=i},i.conflict();var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a={decimalDigits:2,consoleTime:!1},s=[],l={},u={};return{config:e,plugins:t,timers:l,getTimers:function(){return l},setTimers:function(e){l=e},start:function(t,n){var r=i();(u=e()).consoleTime&&console.time(t),l[t]=l[t]||{entries:[]};var o={timestamp:+new Date,start:r};return n&&(o.data=n),l[t].entries.push(o),l[t]},end:function(e){var r=i();u.consoleTime&&console.timeEnd(e);var o=l[e];if(!o)return null;o.plugins={};var a=o.entries,s=a[a.length-1];s.diff=r-s.start,o.last=s.diff,o.sum=(o.sum||0)+s.diff,o.avg=o.sum/a.length,o.name=e,s.avg=o.avg,o.last=n(o.last),s.start=n(s.start),s.end=n(r),s.diff=n(s.diff),o.sum=n(o.sum),o.avg=n(o.avg);for(var f=t(),c=0;c<f.length;c+=1){var m=f[c].plugin;m&&m.run&&(o.plugins[m.name]=m.run(l,o))}return o},clear:function(e){delete l[e];for(var n=t(),r=0;r<n.length;r+=1){var i=n[r].plugin;i&&i.clear&&i.clear()}},msPluginUseLocalStorage:function(){var e=JSON.parse(global.localStorage.getItem("mstime.timers"));return e&&(l=e),{name:"msplugin-use-local-storage",run:function(e,t){global.localStorage.setItem("mstime.timers",JSON.stringify(l));var n=global.localStorage.getItem("mstime.timers");return{createdAt:(new Date).getTime(),totalEntries:t.entries.length,size:n.length}},clear:function(){global.localStorage.setItem("mstime.timers",JSON.stringify(l))}}}}});
